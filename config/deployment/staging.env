# Staging Environment Configuration for Zotero Integration
# This file contains staging-specific environment variables

# Application Environment
NODE_ENV=staging
ENVIRONMENT=staging
DEBUG=true
LOG_LEVEL=DEBUG

# Database Configuration
DB_HOST=${STAGING_DB_HOST}
DB_PORT=${STAGING_DB_PORT:-5432}
DB_NAME=${STAGING_DB_NAME}
DB_USER=${STAGING_DB_USER}
DB_PASSWORD=${STAGING_DB_PASSWORD}
DB_SSL_MODE=prefer
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# Redis Configuration
REDIS_URL=${STAGING_REDIS_URL}
REDIS_PASSWORD=${STAGING_REDIS_PASSWORD}
REDIS_DB=0
REDIS_MAX_CONNECTIONS=25
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# Zotero API Configuration
ZOTERO_CLIENT_ID=${STAGING_ZOTERO_CLIENT_ID}
ZOTERO_CLIENT_SECRET=${STAGING_ZOTERO_CLIENT_SECRET}
ZOTERO_REDIRECT_URI=${STAGING_ZOTERO_REDIRECT_URI}
ZOTERO_API_BASE_URL=https://api.zotero.org
ZOTERO_API_VERSION=3
ZOTERO_API_TIMEOUT=30
ZOTERO_RATE_LIMIT_REQUESTS_PER_SECOND=10
ZOTERO_RATE_LIMIT_BURST=20
ZOTERO_WEBHOOK_SECRET=${STAGING_ZOTERO_WEBHOOK_SECRET}

# Security Configuration
ZOTERO_ENCRYPTION_KEY=${STAGING_ZOTERO_ENCRYPTION_KEY}
SECRET_KEY=${STAGING_SECRET_KEY}
JWT_SECRET=${STAGING_JWT_SECRET}
JWT_EXPIRATION=3600
CORS_ORIGINS=https://staging.aischolar.com,http://localhost:3000
ALLOWED_HOSTS=staging.aischolar.com,localhost

# File Storage Configuration
ZOTERO_ATTACHMENT_PATH=/app/data/staging_zotero_attachments
ZOTERO_MAX_FILE_SIZE=52428800
ZOTERO_ALLOWED_FILE_TYPES=.pdf,.doc,.docx,.txt,.html,.epub
ZOTERO_STORAGE_CLEANUP_INTERVAL=86400
ZOTERO_COMPRESSION_ENABLED=true

# AI Services Configuration
AI_PROVIDER=openai
OPENAI_API_KEY=${STAGING_OPENAI_API_KEY}
AI_MODEL=gpt-3.5-turbo
AI_MAX_TOKENS=1500
AI_TEMPERATURE=0.3
AI_ANALYSIS_BATCH_SIZE=25
AI_SIMILARITY_THRESHOLD=0.7

# Monitoring and Logging
SENTRY_DSN=${STAGING_SENTRY_DSN}
SENTRY_ENVIRONMENT=staging
SENTRY_TRACES_SAMPLE_RATE=0.5
PROMETHEUS_METRICS_ENABLED=true
PROMETHEUS_METRICS_PORT=9090
LOG_FORMAT=json
LOG_FILE_PATH=/app/logs/staging_zotero.log
LOG_MAX_SIZE=50MB
LOG_BACKUP_COUNT=3

# Email Configuration
SMTP_HOST=${STAGING_SMTP_HOST}
SMTP_PORT=${STAGING_SMTP_PORT:-587}
SMTP_USER=${STAGING_SMTP_USER}
SMTP_PASSWORD=${STAGING_SMTP_PASSWORD}
SMTP_USE_TLS=true
FROM_EMAIL=staging-noreply@aischolar.com

# Webhook and Notification Configuration
SLACK_WEBHOOK_URL=${STAGING_SLACK_WEBHOOK_URL}
PAGERDUTY_INTEGRATION_KEY=${STAGING_PAGERDUTY_INTEGRATION_KEY}
WEBHOOK_TIMEOUT=30
NOTIFICATION_RETRY_ATTEMPTS=3

# Performance Configuration
CELERY_BROKER_URL=${STAGING_REDIS_URL}/1
CELERY_RESULT_BACKEND=${STAGING_REDIS_URL}/2
CELERY_WORKER_CONCURRENCY=2
CELERY_TASK_SOFT_TIME_LIMIT=300
CELERY_TASK_TIME_LIMIT=600
CELERY_WORKER_MAX_TASKS_PER_CHILD=500

# Sync Configuration
ZOTERO_SYNC_BATCH_SIZE=50
ZOTERO_MAX_CONCURRENT_SYNCS=2
ZOTERO_SYNC_INTERVAL=1800
ZOTERO_FULL_SYNC_INTERVAL=172800
ZOTERO_SYNC_RETRY_ATTEMPTS=3
ZOTERO_SYNC_RETRY_DELAY=60

# Cache Configuration
CACHE_DEFAULT_TTL=1800
CACHE_SEARCH_TTL=900
CACHE_LIBRARY_TTL=3600
CACHE_CITATION_TTL=43200
CACHE_MAX_ENTRIES=5000

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=200
RATE_LIMIT_BURST=400
RATE_LIMIT_STORAGE_URL=${STAGING_REDIS_URL}/3

# SSL Configuration
SSL_CERT_PATH=/etc/ssl/certs/staging.aischolar.crt
SSL_KEY_PATH=/etc/ssl/private/staging.aischolar.key
SSL_VERIFY=false
FORCE_HTTPS=false

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 3 * * *"
BACKUP_RETENTION_DAYS=7
BACKUP_S3_BUCKET=${STAGING_BACKUP_S3_BUCKET}
BACKUP_S3_ACCESS_KEY=${STAGING_BACKUP_S3_ACCESS_KEY}
BACKUP_S3_SECRET_KEY=${STAGING_BACKUP_S3_SECRET_KEY}

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_DATABASE=true
HEALTH_CHECK_REDIS=true
HEALTH_CHECK_EXTERNAL_APIS=true

# Feature Flags
FEATURE_PDF_PROCESSING=true
FEATURE_ANNOTATION_SYNC=true
FEATURE_GROUP_LIBRARIES=true
FEATURE_COLLABORATION=true
FEATURE_ADVANCED_SEARCH=true
FEATURE_BULK_OPERATIONS=true
FEATURE_AI_ANALYSIS=true
FEATURE_REAL_TIME_SYNC=true

# Limits and Quotas
MAX_LIBRARY_SIZE=10000
MAX_COLLECTIONS=500
MAX_TAGS_PER_ITEM=50
MAX_ATTACHMENTS_PER_ITEM=5
MAX_ANNOTATION_SIZE=5000
MAX_EXPORT_ITEMS=1000
MAX_CONCURRENT_USERS=100

# Deployment Configuration
DEPLOYMENT_VERSION=${DEPLOYMENT_VERSION}
BUILD_DATE=${BUILD_DATE}
GIT_COMMIT=${GIT_COMMIT}
DEPLOYMENT_ENVIRONMENT=staging
BLUE_GREEN_DEPLOYMENT=false
GRACEFUL_SHUTDOWN_TIMEOUT=15
HEALTH_CHECK_GRACE_PERIOD=30